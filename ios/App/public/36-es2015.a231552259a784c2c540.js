(window.webpackJsonp=window.webpackJsonp||[]).push([[36],{mR1q:function(e,t,r){"use strict";r.r(t),r.d(t,"EditProfilePageModule",function(){return O});var o=r("ofXK"),n=r("3Pt+"),i=r("TEn/"),l=r("tyNb"),s=r("mrSG"),c=r("XKlN"),a=r("H98O"),b=r("ZF+8"),u=r("LF58"),g=r("a/9d"),f=r("FAH8"),h=r("fXoL"),m=r("1rxE");function p(e,t){if(1&e&&(h.Ub(0,"small"),h.Dc(1),h.Tb()),2&e){const e=h.ec(2);h.Cb(1),h.Ec(null==e.fg.controls.full_name.errors||null==e.fg.controls.full_name.errors.required?null:e.fg.controls.full_name.errors.required.message)}}function d(e,t){if(1&e&&(h.Ub(0,"small"),h.Dc(1),h.Tb()),2&e){const e=h.ec(2);h.Cb(1),h.Gc("",null==e.fg.controls.email.errors||null==e.fg.controls.email.errors.required?null:e.fg.controls.email.errors.required.message," ",null==e.fg.controls.email.errors||null==e.fg.controls.email.errors.email?null:e.fg.controls.email.errors.email.message,"")}}function T(e,t){if(1&e&&(h.Ub(0,"small"),h.Dc(1),h.Tb()),2&e){const e=h.ec(2);h.Cb(1),h.Ic("",null==e.fg.controls.phone.errors||null==e.fg.controls.phone.errors.required?null:e.fg.controls.phone.errors.required.message," ",null==e.fg.controls.phone.errors||null==e.fg.controls.phone.errors.numeric?null:e.fg.controls.phone.errors.numeric.message," ",null==e.fg.controls.phone.errors||null==e.fg.controls.phone.errors.minLength?null:e.fg.controls.phone.errors.minLength.message," ",null==e.fg.controls.phone.errors||null==e.fg.controls.phone.errors.maxLength?null:e.fg.controls.phone.errors.maxLength.message,"")}}function U(e,t){if(1&e){const e=h.Vb();h.Ub(0,"form",13),h.Ub(1,"ion-row",14),h.Ub(2,"ion-col",15),h.Pb(3,"img",16),h.Tb(),h.Ub(4,"ion-col",17),h.Ub(5,"ion-row"),h.Ub(6,"ion-col",6),h.Ub(7,"ion-text",18),h.Dc(8),h.fc(9,"translate"),h.Tb(),h.Tb(),h.Tb(),h.Tb(),h.Ub(10,"ion-col",19),h.cc("click",function(){return h.vc(e),h.ec().showActionSheet()}),h.Ub(11,"ion-text",9),h.Ub(12,"b"),h.Dc(13),h.fc(14,"translate"),h.Tb(),h.Tb(),h.Tb(),h.Tb(),h.Ub(15,"ion-item",20),h.Ub(16,"ion-label",21),h.Dc(17),h.fc(18,"translate"),h.Tb(),h.Pb(19,"ion-input",22),h.fc(20,"translate"),h.Bc(21,p,2,1,"small",23),h.Tb(),h.Ub(22,"ion-item",20),h.Ub(23,"ion-label",21),h.Dc(24),h.fc(25,"translate"),h.Tb(),h.Pb(26,"ion-input",24),h.fc(27,"translate"),h.Bc(28,d,2,2,"small",23),h.Tb(),h.Ub(29,"ion-item",20),h.Ub(30,"ion-label",21),h.Dc(31),h.fc(32,"translate"),h.Tb(),h.Pb(33,"ion-input",25),h.fc(34,"translate"),h.Bc(35,T,2,4,"small",23),h.Tb(),h.Tb()}if(2&e){const e=h.ec();h.mc("formGroup",e.fg),h.Cb(3),h.mc("src",e.selectedImage,h.xc),h.Cb(5),h.Ec(h.gc(9,13,"PROFILE_PICTURE")),h.Cb(5),h.Ec(h.gc(14,15,"CHANGE")),h.Cb(4),h.Ec(h.gc(18,17,"NAME")),h.Cb(2),h.nc("placeholder",h.gc(20,19,"NAME_PLACEHOLDER")),h.Cb(2),h.mc("ngIf",e.fg.controls.full_name.dirty),h.Cb(3),h.Ec(h.gc(25,21,"EMAIL_ADDRESS")),h.Cb(2),h.nc("placeholder",h.gc(27,23,"YOUR_EMAIL_ADDRESS")),h.Cb(2),h.mc("ngIf",e.fg.controls.email.dirty),h.Cb(3),h.Ec(h.gc(32,25,"PHONE_NUMBER")),h.Cb(2),h.nc("placeholder",h.gc(34,27,"PHONE_NUMBER")),h.Cb(2),h.mc("ngIf",e.fg.controls.phone.dirty)}}const P=function(){return["/change-password"]},C=[{path:"",component:(()=>{class e{constructor(e,t,r,o,n,i,l,s,c,a){this.validatorSrv=e,this.fb=t,this.router=r,this.gs=o,this.translateSrv=n,this.userSrv=i,this.camera=l,this.file=s,this.actionSheetCtrl=c,this.toastSrv=a,this.imagePickerOptions={maximumImagesCount:1,quality:50},this.selectedImage=null,this.userSrv.getProfile().then(e=>{this.currDate=new Date,this.initProfileForm(e)})}ngOnInit(){}initProfileForm(e){this.selectedImage=(null==e?void 0:e.profile_picture)?(null==e?void 0:e.profile_picture)+`?${this.currDate.toString()}`:"https://via.placeholder.com/35.png?text=LOGO+Placeholder",this.validatorSrv.validatorErrorMessage(),this.fg=this.fb.group({profile_picture:[(null==e?void 0:e.profile_picture)?(null==e?void 0:e.profile_picture)+`?${this.currDate.toString()}`:null],full_name:[null==e?void 0:e.full_name,[c.c.required()]],email:[null==e?void 0:e.email,[c.c.required(),c.c.email()]],phone:[null==e?void 0:e.phone,[c.c.required(),c.c.numeric(),c.c.minLength({value:7,message:`${this.translateSrv.get("VALIDATOR_MIN")} 7`}),c.c.maxLength({value:15,message:`${this.translateSrv.get("VALIDATOR_MAX")} 15`})]]})}updateProfile(){if(this.fg.valid){delete this.fg.value.profile_picture;const e=this.getDirtyValues();this.userSrv.updateProfile(e).then(()=>{this.router.navigate(["/tabs/profile"])})}}updateProfilePicture(e){this.userSrv.updateProfilePicture({image:e}).then(e=>{this.toastSrv.show("Photo updated successfully")}).catch(e=>{this.toastSrv.show(e.error.error.message)})}getDirtyValues(){return this.gs.getChangedFormProperties(this.fg)}showActionSheet(){return Object(s.a)(this,void 0,void 0,function*(){const e=yield this.actionSheetCtrl.create({header:`${this.translateSrv.get("SELECT_IMAGE_SOURCE")}`,buttons:[{text:`${this.translateSrv.get("CHOOSE_FROM_GALLERY")}`,handler:()=>{this.pickImage(this.camera.PictureSourceType.PHOTOLIBRARY)}},{text:`${this.translateSrv.get("TAKE_A_PHOTO")}`,handler:()=>{this.pickImage(this.camera.PictureSourceType.CAMERA)}}]});yield e.present()})}pickImage(e){this.camera.getPicture({quality:100,sourceType:e,destinationType:this.camera.DestinationType.DATA_URL,encodingType:this.camera.EncodingType.JPEG,mediaType:this.camera.MediaType.PICTURE,correctOrientation:!0}).then(e=>{const t=`data:image/jpeg;base64,${e}`;this.setImageToForm(t),this.getBlobFile(t).then(e=>{this.updateProfilePicture(e)})})}getBlobFile(e){return new Promise((t,r)=>{fetch(e).then(e=>e.blob()).then(e=>{const r=new Blob([e],{type:"image/jpeg"});t(r)},e=>{r(e)})})}setImageToForm(e){this.selectedImage=e,this.fg.controls.profile_picture.patchValue(e),this.fg.controls.profile_picture.markAsDirty()}}return e.\u0275fac=function(t){return new(t||e)(h.Ob(b.d),h.Ob(n.d),h.Ob(l.g),h.Ob(b.c),h.Ob(a.a),h.Ob(u.m),h.Ob(g.a),h.Ob(f.a),h.Ob(i.a),h.Ob(b.e))},e.\u0275cmp=h.Ib({type:e,selectors:[["app-edit-profile"]],decls:25,vars:13,consts:[[1,"ion-no-border"],["mode","ios"],["slot","start","mode","md"],["icon","chevron-back"],[1,"ion-padding","h-100"],[1,"ion-justify-content-between"],["size","12",1,"ion-no-padding"],[3,"formGroup",4,"ngIf"],["size","12",1,"ion-no-padding",2,"margin-top","12px",3,"routerLink"],[1,"section-see-all",2,"line-height","16px"],[1,"ion-no-border","ion-padding-horizontal"],["size","12"],["expand","block","shape","round","color","success",3,"disabled","click"],[3,"formGroup"],[1,"ion-align-items-center","bg-white"],["size","2",1,"ion-no-padding"],["width","80%",1,"rounded","profile-img",3,"src"],["size","7"],["color","dark"],["size","3",1,"ion-text-right",3,"click"],["lines","none",1,"form-group"],["position","stacked"],["type","text","formControlName","full_name",1,"default-theme",3,"placeholder"],[4,"ngIf"],["type","email","formControlName","email","disabled","",1,"default-theme",3,"placeholder"],["type","tel","formControlName","phone","disabled","",1,"default-theme",3,"placeholder"]],template:function(e,t){1&e&&(h.Ub(0,"ion-header",0),h.Ub(1,"ion-toolbar",1),h.Ub(2,"ion-buttons",2),h.Pb(3,"ion-back-button",3),h.Tb(),h.Ub(4,"ion-title"),h.Dc(5),h.fc(6,"translate"),h.Tb(),h.Tb(),h.Tb(),h.Ub(7,"ion-content"),h.Ub(8,"ion-grid",4),h.Ub(9,"ion-row",5),h.Ub(10,"ion-col",6),h.Bc(11,U,36,29,"form",7),h.Tb(),h.Tb(),h.Ub(12,"ion-row"),h.Ub(13,"ion-col",8),h.Ub(14,"ion-text",9),h.Ub(15,"b"),h.Dc(16),h.fc(17,"translate"),h.Tb(),h.Tb(),h.Tb(),h.Tb(),h.Tb(),h.Tb(),h.Ub(18,"ion-footer",10),h.Ub(19,"ion-grid"),h.Ub(20,"ion-row"),h.Ub(21,"ion-col",11),h.Ub(22,"ion-button",12),h.cc("click",function(){return t.updateProfile()}),h.Dc(23),h.fc(24,"translate"),h.Tb(),h.Tb(),h.Tb(),h.Tb(),h.Tb()),2&e&&(h.Cb(5),h.Ec(h.gc(6,6,"EDIT_PROFILE")),h.Cb(6),h.mc("ngIf",t.fg),h.Cb(2),h.mc("routerLink",h.qc(12,P)),h.Cb(3),h.Ec(h.gc(17,8,"CHANGE_PASSWORD")),h.Cb(6),h.mc("disabled",null==t.fg?null:t.fg.pristine),h.Cb(1),h.Fc(" ",h.gc(24,10,"UPDATE")," "))},directives:[i.t,i.bb,i.i,i.e,i.f,i.ab,i.p,i.s,i.K,i.o,o.n,i.kb,l.h,i.X,i.r,i.h,n.y,n.q,n.i,i.y,i.C,i.x,i.mb,n.p,n.g],pipes:[m.a],styles:[".btn-edit-profile[_ngcontent-%COMP%]{font-size:8px;font-weight:600;line-height:1.25;letter-spacing:normal;color:#9c3}ion-item[_ngcontent-%COMP%]{--padding-start:0px}"]}),e})()}];let E=(()=>{class e{}return e.\u0275mod=h.Mb({type:e}),e.\u0275inj=h.Lb({factory:function(t){return new(t||e)},imports:[[l.j.forChild(C)],l.j]}),e})();var v=r("PCNd");let O=(()=>{class e{}return e.\u0275mod=h.Mb({type:e}),e.\u0275inj=h.Lb({factory:function(t){return new(t||e)},imports:[[o.b,n.j,i.cb,E,n.j,n.v,v.a]]}),e})()}}]);