(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{"9OaD":function(t,e,n){"use strict";n.d(e,"a",function(){return u}),n.d(e,"b",function(){return l});var o=n("fXoL"),i=n("3Pt+"),s=n("ofXK");function r(t,e){if(1&t){const t=o.Vb();o.Ub(0,"input",3),o.cc("keydown",function(e){return o.vc(t),o.ec(2).onKeyDown(e)})("keyup",function(n){o.vc(t);const i=e.index;return o.ec(2).onKeyUp(n,i)}),o.Tb()}if(2&t){const t=e.$implicit,n=e.index,i=o.ec(2);o.Fb("otp-input ",i.config.inputClass,""),o.pc("id","otp_",n,"_",i.componentKey,""),o.mc("pattern",i.config.allowNumbersOnly?"\\d*":"")("type",i.inputType)("placeholder",(null==i.config?null:i.config.placeholder)||"")("disabledNumberOnly",!i.config.allowNumbersOnly)("ngStyle",i.config.inputStyles)("formControl",i.otpForm.controls[t])}}function c(t,e){if(1&t&&(o.Ub(0,"div",1),o.Bc(1,r,1,11,"input",2),o.fc(2,"keys"),o.Tb()),2&t){const t=o.ec();o.Fb("wrapper ",t.config.containerClass,""),o.oc("id","c_",t.componentKey,""),o.mc("ngStyle",t.config.containerStyles),o.Cb(1),o.mc("ngForOf",o.gc(2,6,null==t.otpForm?null:t.otpForm.controls))}}let a=(()=>{class t{transform(t){return Object.keys(t)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=o.Nb({name:"keys",type:t,pure:!0}),t})(),l=(()=>{class t{constructor(t){this.keysPipe=t,this.config={length:4},this.onInputChange=new o.o,this.inputControls=new Array(this.config.length),this.componentKey=Math.random().toString(36).substring(2)+(new Date).getTime().toString(36)}ngOnInit(){this.otpForm=new i.h({});for(let t=0;t<this.config.length;t++)this.otpForm.addControl(this.getControlName(t),new i.e);this.inputType=this.getInputType()}ngAfterViewInit(){if(!this.config.disableAutoFocus){const t=document.getElementById(`c_${this.componentKey}`);if(t){t.addEventListener("paste",t=>this.handlePaste(t));const e=t.getElementsByClassName("otp-input")[0];e&&e.focus&&e.focus()}}}getControlName(t){return`ctrl_${t}`}ifLeftArrow(t){return this.ifKeyCode(t,37)}ifRightArrow(t){return this.ifKeyCode(t,39)}ifBackspaceOrDelete(t){return"Backspace"===t.key||"Delete"===t.key||this.ifKeyCode(t,8)||this.ifKeyCode(t,46)}ifKeyCode(t,e){return(t.keyCode||t.charCode)==e}onKeyDown(t){if(this.ifKeyCode(t,32))return!1}onKeyUp(t,e){const n=this.appendKey(`otp_${e+1}`),o=this.appendKey("otp_"+(e-1));if(this.ifRightArrow(t))this.setSelected(n);else{if(!this.ifLeftArrow(t))return this.ifBackspaceOrDelete(t)&&!t.target.value?(this.setSelected(o),void this.rebuildValue()):void(t.target.value&&(this.ifValidEntry(t)&&this.setSelected(n),this.rebuildValue()));this.setSelected(o)}}appendKey(t){return`${t}_${this.componentKey}`}setSelected(t){this.focusTo(t);const e=document.getElementById(t);e&&e.setSelectionRange&&setTimeout(()=>{e.setSelectionRange(0,1)},0)}ifValidEntry(t){const e=String.fromCharCode(t.keyCode);return/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)||/[a-zA-Z0-9-_]/.test(e)||this.config.allowKeyCodes&&this.config.allowKeyCodes.includes(t.keyCode)||t.keyCode>=96&&t.keyCode<=105}focusTo(t){const e=document.getElementById(t);e&&e.focus()}setValue(t){if(!this.config.allowNumbersOnly||!isNaN(t))if(this.otpForm.reset(),t){if(t=t.toString().replace(/\s/g,""),Array.from(t).forEach((t,e)=>{this.otpForm.get(this.getControlName(e))&&this.otpForm.get(this.getControlName(e)).setValue(t)}),!this.config.disableAutoFocus){const n=document.getElementById(`c_${this.componentKey}`);var e=t.length<this.config.length?t.length:this.config.length-1;let o=n.getElementsByClassName("otp-input")[e];o&&o.focus&&o.focus()}this.rebuildValue()}else this.rebuildValue()}rebuildValue(){let t="";this.keysPipe.transform(this.otpForm.controls).forEach(e=>{this.otpForm.controls[e].value&&(t+=this.otpForm.controls[e].value)}),this.onInputChange.emit(t)}getInputType(){return this.config.isPasswordInput?"password":this.config.allowNumbersOnly?"tel":"text"}handlePaste(t){let e=t.clipboardData||window.clipboardData;if(e)var n=e.getData("Text");t.stopPropagation(),t.preventDefault(),n&&this.setValue(n)}}return t.\u0275fac=function(e){return new(e||t)(o.Ob(a))},t.\u0275cmp=o.Ib({type:t,selectors:[["ng-otp-input"]],inputs:{config:"config"},outputs:{onInputChange:"onInputChange"},decls:1,vars:1,consts:[[3,"class","id","ngStyle",4,"ngIf"],[3,"id","ngStyle"],["numberOnly","","maxlength","1","autocomplete","off",3,"pattern","type","placeholder","disabledNumberOnly","ngStyle","class","formControl","id","keydown","keyup",4,"ngFor","ngForOf"],["numberOnly","","maxlength","1","autocomplete","off",3,"pattern","type","placeholder","disabledNumberOnly","ngStyle","formControl","id","keydown","keyup"]],template:function(t,e){1&t&&o.Bc(0,c,3,8,"div",0),2&t&&o.mc("ngIf",null==e.otpForm?null:e.otpForm.controls)},directives:function(){return[s.n,s.o,s.m,i.b,b,i.k,i.t,i.p,i.f]},pipes:function(){return[a]},styles:[".otp-input[_ngcontent-%COMP%]{width:50px;height:50px;border-radius:4px;border:1px solid #c5c5c5;text-align:center;font-size:32px}.wrapper[_ngcontent-%COMP%]   .otp-input[_ngcontent-%COMP%]:not(:last-child){margin-right:8px}@media screen and (max-width:767px){.otp-input[_ngcontent-%COMP%]{width:40px;font-size:24px;height:40px}}@media screen and (max-width:420px){.otp-input[_ngcontent-%COMP%]{width:30px;font-size:18px;height:30px}}"]}),t})(),b=(()=>{class t{constructor(t,e){this._elRef=t,this._renderer=e}ngOnInit(){this.disabledNumberOnly||this._renderer.setAttribute(this._elRef.nativeElement,"onkeypress","return (event.charCode >= 48 && event.charCode <= 57) || event.charCode == 0")}}return t.\u0275fac=function(e){return new(e||t)(o.Ob(o.m),o.Ob(o.G))},t.\u0275dir=o.Jb({type:t,selectors:[["","numberOnly",""]],inputs:{disabledNumberOnly:"disabledNumberOnly"}}),t})(),u=(()=>{class t{}return t.\u0275mod=o.Mb({type:t}),t.\u0275inj=o.Lb({factory:function(e){return new(e||t)},providers:[a],imports:[[s.b,i.j,i.v]]}),t})()},FIaY:function(t,e,n){"use strict";n.d(e,"a",function(){return U});var o=n("mrSG"),i=n("H98O"),s=n("ZF+8"),r=n("Cmua"),c=n("cdEG"),a=n("FJ7I"),l=n("3WbM"),b=n("wd/R"),u=n("LF58"),d=n("fXoL"),h=n("TEn/"),p=n("1rxE");let f=(()=>{class t{constructor(t,e,n){this.modalCtrl=t,this.userSrv=e,this.toastSrv=n}ngOnInit(){}requestVerification(){this.userSrv.sendEmailVerification().then(()=>{}).catch(t=>{this.toastSrv.show(t.error.error.message),this.dismiss()})}dismiss(){this.modalCtrl.dismiss()}}return t.\u0275fac=function(e){return new(e||t)(d.Ob(h.eb),d.Ob(u.m),d.Ob(s.e))},t.\u0275cmp=d.Ib({type:t,selectors:[["app-modal-email-verification"]],decls:29,vars:12,consts:[[1,"ion-no-border"],["mode","ios"],["slot","end","mode","md"],[3,"click"],["name","close-outline","size","large"],[1,"ion-padding-top","ion-padding-horizontal","h-100"],[1,"ion-align-items-center","ion-justify-content-center","h-100"],["size","12",1,"ion-text-center"],["color","primary"],["color","medium"],[1,"ion-no-border","ion-padding-horizontal"],["expand","block","shape","round","color","success",3,"click"]],template:function(t,e){1&t&&(d.Ub(0,"ion-header",0),d.Ub(1,"ion-toolbar",1),d.Ub(2,"ion-buttons",2),d.Ub(3,"ion-button",3),d.cc("click",function(){return e.dismiss()}),d.Pb(4,"ion-icon",4),d.Tb(),d.Tb(),d.Ub(5,"ion-title"),d.Dc(6),d.fc(7,"translate"),d.Tb(),d.Tb(),d.Tb(),d.Ub(8,"ion-content"),d.Ub(9,"ion-grid",5),d.Ub(10,"ion-row",6),d.Ub(11,"ion-col",7),d.Ub(12,"ion-text",8),d.Ub(13,"span"),d.Ub(14,"b"),d.Dc(15),d.fc(16,"translate"),d.Tb(),d.Tb(),d.Tb(),d.Pb(17,"br"),d.Ub(18,"ion-text",9),d.Ub(19,"small"),d.Dc(20),d.fc(21,"translate"),d.Tb(),d.Tb(),d.Tb(),d.Tb(),d.Tb(),d.Tb(),d.Ub(22,"ion-footer",10),d.Ub(23,"ion-grid"),d.Ub(24,"ion-row"),d.Ub(25,"ion-col"),d.Ub(26,"ion-button",11),d.cc("click",function(){return e.dismiss()}),d.Dc(27),d.fc(28,"translate"),d.Tb(),d.Tb(),d.Tb(),d.Tb(),d.Tb()),2&t&&(d.Cb(6),d.Ec(d.gc(7,4,"VERIFY_EMAIL")),d.Cb(9),d.Ec(d.gc(16,6,"EMAIL_VERIFICATION_SENT")),d.Cb(5),d.Ec(d.gc(21,8,"EMAIL_VERIFICATION_WORDING")),d.Cb(7),d.Fc(" ",d.gc(28,10,"BACK_HOME")," "))},directives:[h.t,h.bb,h.i,h.h,h.u,h.ab,h.p,h.s,h.K,h.o,h.X,h.r],pipes:[p.a],styles:[""]}),t})();var m=n("tyNb");let g=(()=>{class t{constructor(t,e,n,o){this.modalCtrl=t,this.router=e,this.alertSrv=n,this.translateSrv=o}ngOnInit(){}dismiss(){this.router.navigateByUrl("/tabs/home",{replaceUrl:!0}).then(()=>{this.modalCtrl.dismiss(),this.showAlertVerifyEmail()})}showAlertVerifyEmail(){this.alertSrv.presentAlert({header:`${this.translateSrv.get("VERIFY_EMAIL_HEADER")}`,message:`${this.translateSrv.get("VERIFY_EMAIL_BODY")}`,buttons:[{text:`${this.translateSrv.get("SKIP")}`,role:"cancel"},{text:`${this.translateSrv.get("VERIFY")}`,handler:()=>{this.showModalEmailVerification()}}]})}showModalEmailVerification(){return Object(o.a)(this,void 0,void 0,function*(){const t=yield this.modalCtrl.create({component:f});return yield t.present()})}}return t.\u0275fac=function(e){return new(e||t)(d.Ob(h.eb),d.Ob(m.g),d.Ob(r.a),d.Ob(i.a))},t.\u0275cmp=d.Ib({type:t,selectors:[["app-modal-success"]],decls:28,vars:9,consts:[[1,"ion-no-border"],["mode","ios"],["slot","end","mode","md"],[3,"click"],["name","close-outline","size","large"],[1,"ion-padding-top","ion-padding-horizontal","h-100"],[1,"ion-align-items-center","ion-justify-content-center","h-100"],["size","12",1,"ion-text-center"],["color","primary"],["color","medium"],[1,"ion-no-border","ion-padding-horizontal"],["expand","block","shape","round","color","success",3,"click"]],template:function(t,e){1&t&&(d.Ub(0,"ion-header",0),d.Ub(1,"ion-toolbar",1),d.Ub(2,"ion-buttons",2),d.Ub(3,"ion-button",3),d.cc("click",function(){return e.dismiss()}),d.Pb(4,"ion-icon",4),d.Tb(),d.Tb(),d.Ub(5,"ion-title"),d.Dc(6),d.fc(7,"translate"),d.Tb(),d.Tb(),d.Tb(),d.Ub(8,"ion-content"),d.Ub(9,"ion-grid",5),d.Ub(10,"ion-row",6),d.Ub(11,"ion-col",7),d.Ub(12,"ion-text",8),d.Ub(13,"span"),d.Ub(14,"b"),d.Dc(15),d.fc(16,"translate"),d.Tb(),d.Tb(),d.Tb(),d.Pb(17,"br"),d.Ub(18,"ion-text",9),d.Ub(19,"small"),d.Dc(20),d.fc(21,"translate"),d.Tb(),d.Tb(),d.Tb(),d.Tb(),d.Tb(),d.Tb(),d.Ub(22,"ion-footer",10),d.Ub(23,"ion-grid"),d.Ub(24,"ion-row"),d.Ub(25,"ion-col"),d.Ub(26,"ion-button",11),d.cc("click",function(){return e.dismiss()}),d.Dc(27," Ok "),d.Tb(),d.Tb(),d.Tb(),d.Tb(),d.Tb()),2&t&&(d.Cb(6),d.Ec(d.gc(7,3,"VERIFY_PHONE_NUMBER")),d.Cb(9),d.Ec(d.gc(16,5,"PHONE_NUMBER_VERIFIED")),d.Cb(5),d.Ec(d.gc(21,7,"WELCOME_GROCIE")))},directives:[h.t,h.bb,h.i,h.h,h.u,h.ab,h.p,h.s,h.K,h.o,h.X,h.r],pipes:[p.a],styles:[""]}),t})();var y=n("9OaD"),C=n("ofXK");function O(t,e){1&t&&d.Qb(0)}function T(t,e){if(1&t&&(d.Ub(0,"small"),d.Dc(1),d.Tb()),2&t){const t=d.ec();d.Cb(1),d.Ec(t.formattedCountdown())}}function w(t,e){if(1&t){const t=d.Vb();d.Ub(0,"ion-text",16),d.cc("click",function(){return d.vc(t),d.ec().setBanOtp()}),d.Ub(1,"small"),d.Dc(2),d.fc(3,"translate"),d.Tb(),d.Tb()}2&t&&(d.Cb(2),d.Ec(d.gc(3,1,"RESEND_OTP")))}function v(t,e){1&t&&d.Pb(0,"ion-spinner",17)}let U=(()=>{class t{constructor(t,e,n,o,i,s,r,c){this.modalCtrl=t,this.alertSrv=e,this.translateSrv=n,this.gs=o,this.otpSrv=i,this.userSrv=s,this.toastSrv=r,this.authSrv=c,this.otpConfig={allowNumbersOnly:!0,length:4,isPasswordInput:!1,disableAutoFocus:!1,placeholder:"",inputStyles:{width:"50px",height:"50px"}},this.otpValue=null,this.countdown=null,this.userData=null,this.isOnFetch=!1}ngOnInit(){}ionViewDidEnter(){this.observeFetchState()}observeFetchState(){this.gs.observeOnFetch().subscribe(t=>{this.isOnFetch=t})}ionViewWillEnter(){this.sendOtp(),this.setupCountdown(),this.fetchUserData()}ionViewDidDismiss(){this.gs.unsubscribeSubscriptions()}setupCountdown(){const t=this.otpSrv.banCountdown.asObservable();this.gs.pushSubscription(t),this.setBanOtp(),t.subscribe(t=>{this.countdown=0===t?0:t})}setBanOtp(){this.sendOtp(),this.otpSrv.setBanResendOtp()}formattedCountdown(){return b.utc(1e3*this.countdown).format("mm:ss")}verifyOtp(){this.authSrv.verifyPhone({phone:this.userData.phone,token:this.otpValue}).then(t=>{if(t)this.showSuccessOtpModal();else{const t=this.translateSrv.get("INVALID_OTP");this.toastSrv.show(t)}}).catch(t=>{this.toastSrv.show(t.error.error.message)})}onOtpChange(t){this.otpValue=t}dismiss(){this.alertSrv.presentAlert({message:`${this.translateSrv.get("CLOSE_CONFIRM")}`,buttons:[{text:"Ok",handler:()=>{this.modalCtrl.dismiss()}},{text:`${this.translateSrv.get("CANCEL")}`,role:"cancel"}]})}showSuccessOtpModal(){return Object(o.a)(this,void 0,void 0,function*(){this.otpSrv.banCountdown.complete(),yield this.modalCtrl.dismiss();const t=yield this.modalCtrl.create({component:g,swipeToClose:!0,presentingElement:yield this.modalCtrl.getTop()});return yield t.present()})}fetchUserData(){this.userSrv.getProfile().then(t=>{this.userData=t})}sendOtp(){this.userSrv.sendOtp().then(t=>{if(!t){const t=this.translateSrv.get("INVALID_OTP");this.toastSrv.show(t)}}).catch(t=>{this.toastSrv.show(t.error.error.message)})}}return t.\u0275fac=function(e){return new(e||t)(d.Ob(h.eb),d.Ob(r.a),d.Ob(i.a),d.Ob(s.c),d.Ob(c.a),d.Ob(a.a),d.Ob(l.a),d.Ob(s.a))},t.\u0275cmp=d.Ib({type:t,selectors:[["app-modal-otp"]],decls:33,vars:15,consts:[[1,"ion-no-border"],["mode","ios"],["slot","end","mode","md"],[3,"click"],["name","close-outline","size","large"],[1,"ion-padding-top","ion-padding-horizontal","h-100"],["size","12",1,"ion-text-center"],[1,"ion-text-center","ion-margin-vertical"],["size","12"],[3,"config","onInputChange"],[4,"ngIf","ngIfThen","ngIfElse"],["countdownComp",""],["resendComp",""],[1,"ion-no-border","ion-padding-horizontal"],["expand","block","shape","round","color","success",3,"disabled","click"],["name","dots","color","dark",4,"ngIf"],["color","primary",3,"click"],["name","dots","color","dark"]],template:function(t,e){if(1&t&&(d.Ub(0,"ion-header",0),d.Ub(1,"ion-toolbar",1),d.Ub(2,"ion-buttons",2),d.Ub(3,"ion-button",3),d.cc("click",function(){return e.dismiss()}),d.Pb(4,"ion-icon",4),d.Tb(),d.Tb(),d.Ub(5,"ion-title"),d.Dc(6),d.fc(7,"translate"),d.Tb(),d.Tb(),d.Tb(),d.Ub(8,"ion-content"),d.Ub(9,"ion-grid",5),d.Ub(10,"ion-row"),d.Ub(11,"ion-col",6),d.Ub(12,"small"),d.Dc(13),d.fc(14,"translate"),d.Tb(),d.Tb(),d.Tb(),d.Ub(15,"ion-row",7),d.Ub(16,"ion-col",8),d.Ub(17,"ng-otp-input",9),d.cc("onInputChange",function(t){return e.onOtpChange(t)}),d.Tb(),d.Tb(),d.Tb(),d.Ub(18,"ion-row"),d.Ub(19,"ion-col",6),d.Bc(20,O,1,0,"ng-container",10),d.Bc(21,T,2,1,"ng-template",null,11,d.Cc),d.Bc(23,w,4,3,"ng-template",null,12,d.Cc),d.Tb(),d.Tb(),d.Tb(),d.Tb(),d.Ub(25,"ion-footer",13),d.Ub(26,"ion-grid"),d.Ub(27,"ion-row"),d.Ub(28,"ion-col"),d.Ub(29,"ion-button",14),d.cc("click",function(){return e.verifyOtp()}),d.Dc(30),d.fc(31,"translate"),d.Bc(32,v,1,0,"ion-spinner",15),d.Tb(),d.Tb(),d.Tb(),d.Tb(),d.Tb()),2&t){const t=d.uc(22),n=d.uc(24);d.Cb(6),d.Ec(d.gc(7,9,"ENTER_OTP")),d.Cb(7),d.Fc("",d.gc(14,11,"OTP_WORDING")," "),d.Cb(4),d.mc("config",e.otpConfig),d.Cb(3),d.mc("ngIf",e.countdown>0)("ngIfThen",t)("ngIfElse",n),d.Cb(9),d.mc("disabled",4!==(null==e.otpValue?null:e.otpValue.length)||e.isOnFetch),d.Cb(1),d.Fc(" ",d.gc(31,13,"VERIFY")," "),d.Cb(2),d.mc("ngIf",e.isOnFetch)}},directives:[h.t,h.bb,h.i,h.h,h.u,h.ab,h.p,h.s,h.K,h.o,y.b,C.n,h.r,h.X,h.T],pipes:[p.a],styles:[""]}),t})()},Hljq:function(t,e,n){"use strict";n.d(e,"a",function(){return b});var o=n("ofXK"),i=n("TEn/"),s=n("PCNd"),r=n("9OaD"),c=n("3Pt+"),a=n("fXoL");let l=(()=>{class t{}return t.\u0275mod=a.Mb({type:t}),t.\u0275inj=a.Lb({factory:function(e){return new(e||t)},imports:[[o.b,i.cb.forRoot(),s.a]]}),t})(),b=(()=>{class t{}return t.\u0275mod=a.Mb({type:t}),t.\u0275inj=a.Lb({factory:function(e){return new(e||t)},imports:[[o.b,i.cb.forRoot(),s.a,r.a,c.j,l]]}),t})()}}]);